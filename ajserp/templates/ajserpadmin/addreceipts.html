{% extends './base.html' %} {% load static %} {% block content %}
<div class="wrapper">
  <!-- Sidebar -->
  {% include "./includes/sidebar.html" %}

  <div class="main-panel">
    <div class="main-header" style="background: content-box !important">
      <div class="main-header-logo">
        <!-- navbar -->
        {% include "./includes/navbar.html" %}
      </div>

      <!-- main content-->

      <div class="container">
        <div class="page-inner ps-2 pe-2">
          <div class="page-header">
            <h3 class="fw-bold mb-3">Create Receipts</h3>
            <ul class="breadcrumbs mb-3">
              <li class="nav-home">
                <a href="{%url 'ajserp:dashboard'%}">
                  <i class="icon-home"></i>
                </a>
              </li>
              <li class="separator">
                <i class="icon-arrow-right"></i>
              </li>
              <li class="nav-item">
                <a href="receipts.html">Receipts</a>
              </li>

              <li class="nav-item">
                <a href="allitems.html"></a>
              </li>
              <li class="separator">
                <i class="icon-arrow-right"></i>
              </li>
              <li class="nav-item">
                <a href="#">Create Receipts</a>
              </li>
            </ul>
          </div>
          <!-- ============add table start============= -->
          <div class="row">
            <div class="col-md-12">
              <div class="card">
                <div class="card-header">
                  <div class="card-title">Receipts</div>
                </div>

                <form method="POST" action="{% url 'ajserp:addreceipts' %}" enctype="multipart/form-data" id="receiptForm">
                  {% csrf_token %}

                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="exampleFormControlSelect1"
                          >Collected By</label
                        >
                      <input
                            type="text"
                            class="form-control"
                            id="collectedBy"
                            name="collected_by"
                            value="{{ request.user.get_full_name }}"
                            readonly
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Collection ID</label>
                        <input
                            type="text"
                            class="form-control"
                            id="collectionId"
                            value="Auto-generated"
                            readonly
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="date">Collection Date</label>
                         <input
                            type="date"
                            class="form-control"
                            id="collectionDate"
                            name="collection_date"
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Customer Code</label>
                         <input
                            type="text"
                            class="form-control"
                            id="customerCode"
                            name="customer_code"
                            placeholder="Enter customer code"
                          />
                          <div id="customerSuggestions" class="customer-suggestions">
                            <!-- Suggestions will be populated here -->
                      </div>
                    </div>
                  </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Customer Name</label>
                        <input
                            type="text"
                            class="form-control"
                            id="customerName"
                            name="customer_name"
                            readonly
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="invoiceNumbers">Invoice Number</label >
                         {% comment %} <div
                        style="
                          position: relative;
                          font-family: Arial, sans-serif;
                        "
                      >
                        <!-- Dropdown toggle -->
                        <button
                          type="button"
                          id="dropdownBtn"
                          style="
                            width: 100%;
                            padding: 5px 10px;
                            border: 1px solid #ced4da;
                            border-radius: 0.375rem;
                            background: #fff;
                            text-align: left;
                            display: flex;
                            flex-wrap: wrap;
                            gap: 3px;
                          "
                          onclick="toggleDropdown(event)"
                        >
                          <span id="placeholder" style="color: #6c757d"
                            >Select Invoice Number</span
                          >
                          <span
                            style="
                              margin-left: auto;
                              border: 5px solid transparent;
                              border-top-color: #495057;
                              margin-top: 5px;
                            "
                          ></span>
                        </button>

                        <!-- Dropdown menu -->
                        <div
                          id="dropdown"
                          style="
                            display: none;
                            position: absolute;
                            top: 100%;
                            left: 0;
                            right: 0;
                            border: 1px solid #ced4da;
                            border-radius: 0.375rem;
                            background: #fff;
                            max-height: 200px;
                            overflow-y: auto;
                            z-index: 100;
                          "
                        >
                          <!-- Select All -->
                          <label
                            style="
                              display: flex;
                              align-items: center;
                              padding: 5px;
                              cursor: pointer;
                              font-weight: bold;
                            "
                          >
                            <input
                              type="checkbox"
                              value="selectAll"
                              id="selectAll"
                              onclick="toggleAll(this); event.stopPropagation();"
                              style="margin-right: 8px"
                            />
                            Select All
                          </label>
                          <!-- Options -->
                          <label
                            style="
                              display: flex;
                              align-items: center;
                              padding: 5px;
                              cursor: pointer;
                            "
                          >
                            <input
                              type="checkbox"
                              value="INV001"
                              onclick="updateTags(); event.stopPropagation();"
                              style="margin-right: 8px"
                            />
                            INV001
                          </label>
                          <label
                            style="
                              display: flex;
                              align-items: center;
                              padding: 5px;
                              cursor: pointer;
                            "
                          >
                            <input
                              type="checkbox"
                              value="INV002"
                              onclick="updateTags(); event.stopPropagation();"
                              style="margin-right: 8px"
                            />
                            INV002
                          </label>
                          <label
                            style="
                              display: flex;
                              align-items: center;
                              padding: 5px;
                              cursor: pointer;
                            "
                          >
                            <input
                              type="checkbox"
                              value="INV003"
                              onclick="updateTags(); event.stopPropagation();"
                              style="margin-right: 8px"
                            />
                            INV003
                          </label>
                          <label
                            style="
                              display: flex;
                              align-items: center;
                              padding: 5px;
                              cursor: pointer;
                            "
                          >
                            <input
                              type="checkbox"
                              value=" INV004"
                              onclick="updateTags(); event.stopPropagation();"
                              style="margin-right: 8px"
                            />
                            INV004
                          </label>
                          <label
                            style="
                              display: flex;
                              align-items: center;
                              padding: 5px;
                              cursor: pointer;
                            "
                          >
                            <input
                              type="checkbox"
                              value=" INV005"
                              onclick="updateTags(); event.stopPropagation();"
                              style="margin-right: 8px"
                            />
                            INV005
                          </label>
                        </div>
                      </div>
                    </div>
        </div>
           {% endcomment %}
             <div>
                            <button
                              type="button"
                              id="dropdownBtn"
                              onclick="toggleDropdown(event)"
                            >
                              <span id="placeholder">Select Invoice Number</span>
                              <span></span>
                            </button>

                            <div id="dropdown">
                              <label>
                                <input
                                  type="checkbox"
                                  value="selectAll"
                                  id="selectAll"
                                  onclick="toggleAll(this); event.stopPropagation();"
                                />
                                Select All
                              </label>
                              <!-- Options will be populated dynamically -->
                            </div>
                          </div>
                          <!-- ADD THIS: Hidden field for selected invoices -->
                          <input type="hidden" name="invoice_numbers" id="selectedInvoices">
                        </div>
                      </div>
                    
                    
                
                  

                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Total Outstanding</label>
                         <input
                            type="text"
                            class="form-control"
                            id="totalOutstanding"
                            name="total_outstanding"
                            readonly
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="exampleFormControlSelect1"
                          >Payment Method</label
                        >
                        <select
                          class="form-select form-control"
                           id="paymentMethod"
                            name="payment_method"
                        >
                          <option>Select type</option>
                          <option>Cash</option>
                          <option>Cheque</option>
                          <option>DD</option>
                          <option>NEFT</option>
                          <option>RTGS</option>
                          <option>UPI</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Payment Reference</label>
                         <input
                            type="text"
                            class="form-control"
                            id="paymentReference"
                            name="payment_reference"
                            placeholder="Cheque No/UTR No/etc."
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Amount Collected</label>
                        <div class="input-group">
                          <span class="input-group-text">â‚¹</span>
                           <input
                              type="number"
                              class="form-control"
                              id="amountCollected"
                              name="amount_collected"
                              step="0.01"
                              min="0"
                              placeholder="0.00"
                              disabled
                            />
                        </div>
                      </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="text">Balance Outstanding</label>
                        <input
                            type="text"
                            class="form-control"
                            id="balanceOutstanding"
                            name="balance_outstanding"
                            readonly
                          />
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                      <div class="form-group">
                        <label for="uploadImages" class="form-label mb-1"
                          >Upload Images</label
                        >
                       <input
                            type="file"
                            class="form-control"
                            id="uploadImages"
                            name="uploaded_images"
                          />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <label for="name">Remarks</label>
                         <textarea
                            class="form-control"
                            id="remarks"
                            name="remarks"
                            rows="3"
                          ></textarea>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-action text-end">
                  <button
                    class="btn btn-success"
                    style="width: 91px; height: 36px; padding-left: 6px"
                  >
                    Submit
                  </button>
                  {% comment %} <button
                    class="btn btn-danger"
                    style="width: 91px; height: 36px; padding-left: 6px"
                  >
                    Cancel
                  </button> {% endcomment %}
                  <button type="button" class="btn btn-danger"  style="width: 91px; height: 36px; padding-left: 6px" onclick="history.back()"> Cancel</button>
                </div>
                 </form> 
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ===============footer======================= -->

      {% include "./includes/footer.html" %}
    </div>
    <!-- custom template setting -->
    {% include "./includes/template_setting.html" %}
  </div>
</div>

<!-- ADD THIS: Hidden field for current user -->
<input type="hidden" id="currentUser" value="{{ request.user.get_full_name }}">

{%endblock%}