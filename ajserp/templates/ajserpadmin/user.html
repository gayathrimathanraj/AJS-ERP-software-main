{% extends './base.html' %} {% load static %} {% block content %}
<div class="wrapper">
  <!-- Sidebar -->
  {% include "./includes/sidebar.html" %}

  <div class="main-panel">
    <div class="main-header" style="background: content-box !important">
      <div class="main-header-logo">
        <!-- navbar -->
        {% include "./includes/navbar.html" %}
      </div>

      <!--main content-->
      <div class="container">
        <div class="row">
          <div class="">
            <h3 class="fw-bold ms-3 ps-3 mb-4 mt-3">User</h3>
            <div class="page-header mb-0">
              <div class="col-md-9 col-sm-8">
                <ul class="breadcrumbs mb-2">
                  <li class="nav-home">
                    <a href="{%url 'ajserp:dashboard'%}">
                      <i class="icon-home"></i>
                    </a>
                  </li>
                  <li class="separator">
                    <i class="icon-arrow-right"></i>
                  </li>
                  <li class="nav-item">
                    <a href="#">User</a>
                  </li>
                  <li class="separator">
                    <i class="icon-arrow-right"></i>
                  </li>
                  <li class="nav-item">
                    <a href="#">Add User</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- =================================Warehouse table start======================== -->

        <div class="container-fluid mt-4">
          <div class="col-md-12">
            <div class="card">
              <div class="card-body" style="padding: 1.25rem">
                <div class="col-md-2 offset-md-10">
                  <input
                    class="form-control form-control-sm mb-3"
                    id="tableSearch"
                    type="text"
                    placeholder="Search..."
                  />
                </div>
                {% comment %} ============================table
                start============ {% endcomment %}
                <div class="table-responsive">
                  <table
                    class="table table-bordered table-sm table-striped align-middle table-hover text-center"
                  >
                    <thead style="padding: 13px 9px !important">
                      <tr>
                        <th style="padding: 13px 9px !important">
                          <input type="checkbox" />
                        </th>
                        <th style="padding: 13px 9px !important">Name</th>
                        <th style="padding: 13px 9px !important">
                          Designation
                        </th>
                        <th style="padding: 13px 9px !important">Role</th>
                        <th style="padding: 13px 9px !important">Department</th>
                        <th style="padding: 13px 9px !important">Location</th>
                        <th style="padding: 13px 9px !important">Report To</th>
                        <th style="padding: 13px 9px !important">Operating</th>
                        <th style="padding: 13px 9px !important">Mobile</th>
                        <th style="padding: 13px 9px !important">Action</th>
                      </tr>
                    </thead>
                   <tbody>
    {% for u in users %}
    <tr>
        <td><input type="checkbox"></td>

        <!-- USERNAME -->
        <td>{{ u.username }}</td>

        <!-- DESIGNATION -->
        <td>{{ u.profile.designation }}</td>

        <!-- ROLE -->
        <td>
            {% if u.is_staff %}
                Admin
            {% else %}
                User
            {% endif %}
        </td>

        <!-- DEPARTMENT -->
        <td>{{ u.profile.department }}</td>

        <!-- LOCATION -->
        <td>{{ u.profile.location }}</td>

        <!-- REPORT TO -->
        <td>
            {% if u.profile.report_to %}
                {{ u.profile.report_to.username }}
            {% else %}
                -
            {% endif %}
        </td>

        <!-- OPERATING -->
        <td>{{ u.profile.operating }}</td>

        <!-- MOBILE -->
        <td>{{ u.profile.mobile }}</td>

        <!-- ACTION -->
        <td>
            <div class="form-button-action">

                <button type="button"
                    class="btn btn-link btn-primary btn-lg">
                    <i class="fa fa-edit"></i>
                </button>

                <button type="button"
                    data-bs-toggle="modal"
                    data-bs-target="#deleteUser{{ u.id }}"
                    class="btn btn-link btn-danger">
                    <i class="fa fa-times"></i>
                </button>

                <!-- Delete Modal -->
                <div class="modal fade" id="deleteUser{{ u.id }}">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <div class="modal-header">
                                <h4 class="modal-title">Delete User</h4>
                                <button class="btn-close" data-bs-dismiss="modal"></button>
                            </div>

                            <div class="modal-body text-center">
                                <p>Are you sure you want to delete <b>{{ u.username }}</b>?</p>
                            </div>

                            <div class="modal-footer" style="text-align:center;">
                                <a href="{% url 'ajserp:delete_user' u.id %}" class="btn btn-success">Yes</a>
                                <button class="btn btn-danger" data-bs-dismiss="modal">No</button>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </td>
    </tr>
    {% endfor %}
</tbody>

                  </table>
                </div>
                <button
                  class="btn btn-md btn-primary mt-4"
                  data-bs-toggle="modal"
                  data-bs-target="#myModaluser"
                >
                  + Add User
                </button>

                {% comment %} ============================view model
                start=====================/> {% endcomment %}
                <!-- The Modal -->
                <div class="modal fade" id="myModaluser">
                  <div
                    class="modal-dialog modal-lg"
                    style="--bs-modal-width: 737px !important"
                  >
                    <div class="modal-content">
                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Add User</h4>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                        ></button>
                      </div>

                      <!-- Modal body -->
                      <!-- ============Form START============= -->
<form method="POST">
  {% csrf_token %}

  <div class="container-fluid">
    <div class="row mb-3 mt-4">

      <div class="col-md-3">
        <i class="fas fa-user-circle" style="font-size: 9em; color: gray;"></i>
      </div>

      <div class="col-md-9">

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Name</label>
          <div class="col-md-7">
            <input type="text" name="name" class="form-control" required/>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Designation</label>
          <div class="col-md-7">
            <input type="text" name="designation" class="form-control"/>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Role</label>
          <div class="col-md-7">
            <select name="role" class="form-select">
              <option>User</option>
              <option>Admin</option>
            </select>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Department</label>
          <div class="col-md-7">
            <input type="text" name="department" class="form-control"/>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Location</label>
          <div class="col-md-7">
            <input type="text" name="location" class="form-control"/>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Operating</label>
          <div class="col-md-7">
            <select name="operating" class="form-select">
              <option>In-office</option>
              <option>Remote</option>
            </select>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Mobile</label>
          <div class="col-md-7">
            <input type="text" name="mobile" class="form-control"/>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Email</label>
          <div class="col-md-7">
            <input type="email" name="email" class="form-control" required/>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Report To</label>
          <div class="col-md-7">
            <select name="report_to" class="form-select">
              <option value="">Select</option>
              {% for u in all_users %}
              <option value="{{ u.id }}">{{ u.username }}</option>
              {% endfor %}
            </select>
          </div>
        </div>

        <div class="mb-3 row">
          <label class="col-md-3 col-form-label">Remarks</label>
          <div class="col-md-7">
            <input type="text" name="remarks" class="form-control"/>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="modal-footer" style="text-align:center">
    <button type="submit" class="btn btn-success">Save</button>
    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
  </div>

</form>

                     
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- ======================table end main content======================== -->

      <!-- ====================footer start========================= -->

      {% include "./includes/footer.html" %}
    </div>

    <!-- custom template setting -->
    {% include "./includes/template_setting.html" %}
  </div>

  {% endblock %}